---
title: "Week 2 assignment"
author: "Jonathan Roberts"
date: "24 March 2017"
output: html_document
---

#Get up and running
##Global RMarkdown Parameters
Are set here

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

##Install the R markdown packages and library

```{r message = FALSE, warning = TRUE}
libraries <- c("rmarkdown")

#UNCOMMENT TO INSTALL PACKAGES
#lapply(libraries, install.packages)
lapply(libraries, library, character.only = TRUE)
```


## Working Directory: 
Set up where you are working and what is in the directory and what objects you have

```{r}

# SET THE WORKING DIRECTORY
setwd("/Users/jonathanroberts/Documents/R/John_Hopkins_Rbasics")
dir()
ls()

```

#Assignment: Part 1

Write a function named 'pollutantmean' that calculates the mean of a pollutant (sulfate or nitrate) across a specified list of monitors. The function 'pollutantmean' takes three arguments: 'directory', 'pollutant', and 'id'. Given a vector monitor ID numbers, 'pollutantmean' reads that monitors' particulate matter data from the directory specified in the 'directory' argument and returns the mean of the pollutant across all of the monitors, ignoring any missing values coded as NA. A prototype of the function is as follows

```{r}

pollutantmean <- function(directory, pollutant, id = 1:332){
    ##directory is a character vector of length 1 indicating the location of the CCSV        files
    ## pollutant is a character vector of length 1 indicating which pollutant we want to call data on: either sulfate or nitrate
    ## id is the intedger vector indicating which monitor station we want
    ## overall function returns the mean of the pollutant - ignoring NA's
    
    
    # we want a bit of the function to read csv
    ## TO FIX: ONLY WORKS IF ID>=100
    getwd()    
    folder<-paste(getwd(),directory,id, sep = "/")
    filename<-paste(folder,"csv", sep=".")
    pollute_data<-read.csv(file = filename)
    colnames(pollute_data) 

    data_choice<-pollute_data[[pollutant]]
    data_choice
    mean(data_choice, na.rm = TRUE)
    
}

pollutantmean("specdata", "sulfate", id = 100)
 


    directory<-"specdata"
    id<-200:240
    pollutant<-"sulfate"
    
    #first data set
    getwd()    
    folder<-paste(getwd(),directory,id, sep = "/")
    filename<-paste(folder,"csv", sep=".")
    filename # this is a vector of filenames!
    
    ## Aboce here is vectorised, below is not#########

    ##Function still doesn;t really work for numbers <100
    ##TODO, not sure i really need the if (i==1) loop or i can 'initialise' another way.

    for (i in seq_along(id)) {
        pollute_data<-read.csv(file = filename[i])
        if(i == 1){
            full_data_df<-pollute_data
            check_row<-nrow(pollute_data)
        }
        else{
            full_data_df<-rbind.data.frame(full_data_df,pollute_data)
            check_row <- check_row + nrow(pollute_data)    
        }
    }
    #TEST IF WE HAVE EQUAL rows i nour data and our data.frame
    nrow(full_data_df) == check_row
    full_data_choice<-full_data_df[[pollutant]]
    mean(full_data_choice, na.rm = TRUE)
    
            
  

```






